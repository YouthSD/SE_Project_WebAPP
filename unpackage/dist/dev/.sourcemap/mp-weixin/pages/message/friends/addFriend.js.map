{"version":3,"file":"addFriend.js","sources":["pages/message/friends/addFriend.vue","D:/HTML5/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXNcbWVzc2FnZVxmcmllbmRzXGFkZEZyaWVuZC52dWU"],"sourcesContent":["<template>\n  <view class=\"container\">\n    \n    <view class=\"header\" :style=\"{backgroundColor: primaryColor}\">\n      <back-icon icon-size=\"50\" @click=\"goBack\" class=\"back-icon\"></back-icon>\n      <text class=\"page-title\">添加好友</text>\n    </view>\n    \n    <view class=\"search-box\">\n      <input \n        class=\"search-input\" \n        placeholder=\"输入昵称或用户名搜索\" \n        v-model=\"searchKeyword\"\n        @confirm=\"searchUser\"\n      />\n      <button class=\"search-btn\" :style=\"{backgroundColor: primaryColor}\" @click=\"searchUser\">搜索</button>\n    </view>\n    \n    <scroll-view scroll-y class=\"result-list\">\n      <view v-if=\"searchStatus === 'searching'\" class=\"status-msg\">\n        <text>正在搜索...</text>\n      </view>\n      <view v-else-if=\"searchStatus === 'empty'\" class=\"status-msg\">\n        <text>未找到用户 \"{{ searchKeyword }}\"</text>\n      </view>\n      \n      <view v-if=\"searchedUser\" class=\"user-item\">\n        <image :src=\"searchedUser.avatar\" class=\"avatar\" mode=\"aspectFill\"></image>\n        <view class=\"user-info\">\n          <text class=\"user-nickname\">{{ searchedUser.nickname }}</text>\n          <text class=\"user-username\">@{{ searchedUser.username }}</text>\n        </view>\n        <button \n          class=\"add-btn\" \n          :style=\"{backgroundColor: primaryColor}\" \n          @click=\"sendRequest(searchedUser)\"\n          :disabled=\"searchedUser.isFriend || searchedUser.hasSentRequest\"\n        >\n          {{ getButtonText(searchedUser) }}\n        </button>\n      </view>\n    </scroll-view>\n  </view>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      primaryColor: '#00CC99',\n      searchKeyword: '',\n      searchStatus: 'idle', // 'idle', 'searching', 'empty', 'found'\n      searchedUser: null, // 搜索到的用户对象\n    };\n  },\n  methods: {\n    goBack() {\n      uni.navigateBack();\n    },\n    \n    getButtonText(user) {\n      if (user.isFriend) return '已是好友';\n      if (user.hasSentRequest) return '已发送请求';\n      return '添加好友';\n    },\n    \n    // 搜索用户\n    searchUser() {\n      const keyword = this.searchKeyword.trim();\n      if (!keyword) {\n        uni.showToast({ title: '请输入搜索关键词', icon: 'none' });\n        return;\n      }\n      \n      this.searchStatus = 'searching';\n      this.searchedUser = null;\n\n      // ** 模拟接口调用：搜索用户 **\n      // 接口：/api/users/search\n      // 参数：{ keyword: keyword }\n      /*\n      uni.request({ \n        url: '/api/users/search', \n        data: { keyword: keyword },\n        success: (res) => {\n          this.searchStatus = res.data.data ? 'found' : 'empty';\n          this.searchedUser = res.data.data; // 假设返回 {id, username, nickname, avatar, isFriend, hasSentRequest}\n        },\n        fail: () => {\n          this.searchStatus = 'idle';\n          uni.showToast({ title: '搜索失败', icon: 'none' });\n        }\n      });\n      */\n      \n      // ** 前端临时模拟 **\n      setTimeout(() => {\n        if (keyword === 'test') {\n          this.searchedUser = { \n            id: 201, \n            username: 'tester', \n            nickname: '测试用户', \n            avatar: '/static/avatar4.jpg', \n            isFriend: false, \n            hasSentRequest: false \n          };\n          this.searchStatus = 'found';\n        } else {\n          this.searchedUser = null;\n          this.searchStatus = 'empty';\n        }\n      }, 500);\n    },\n    \n    // 发送好友请求\n    sendRequest(user) {\n      uni.showModal({\n        title: '添加好友',\n        content: `确定要向 ${user.nickname} 发送好友请求吗？`,\n        confirmText: '发送',\n        success: (res) => {\n          if (res.confirm) {\n            // ** 模拟接口调用：发送好友请求 **\n            // 接口：/api/friends/sendRequest\n            // 参数：{ targetUserId: user.id }\n            /*\n            uni.request({ \n              url: '/api/friends/sendRequest', \n              method: 'POST', \n              data: { targetUserId: user.id },\n              success: (res) => {\n                if (res.data.code === 0) {\n                  uni.showToast({ title: '请求已发送', icon: 'success' });\n                  user.hasSentRequest = true; // 立即更新按钮状态\n                } else {\n                  uni.showToast({ title: res.data.message || '发送失败', icon: 'none' });\n                }\n              }\n            });\n            */\n            // ** 临时成功模拟 **\n            uni.showToast({ title: '请求已发送', icon: 'success' });\n            user.hasSentRequest = true;\n          }\n        }\n      });\n    }\n  }\n}\n</script>\n\n<style scoped>\n.container {\n  display: flex;\n  flex-direction: column;\n  height: 100vh;\n  background-color: #f7fff7;\n}\n\n/* --- 顶部导航栏 (与 friendList 样式保持一致) --- */\n.header {\n  height: 90rpx;\n  display: flex;\n  align-items: center;\n  position: relative;\n  color: #ffffff;\n  font-weight: bold;\n  padding-top: var(--status-bar-height);\n  background-color: v-bind(primaryColor);\n}\n\n.back-icon {\n  position: absolute;\n  left: 30rpx;\n  font-size: 40rpx;\n  cursor: pointer;\n}\n.page-title {\n  flex: 1;\n  text-align: center;\n  font-size: 38rpx;\n  margin-right: 60rpx;\n}\n\n/* --- 搜索框 --- */\n.search-box {\n  padding: 20rpx 30rpx;\n  background-color: #ffffff;\n  display: flex;\n  align-items: center;\n  border-bottom: 1rpx solid #eee;\n}\n\n.search-input {\n  flex: 1;\n  height: 70rpx;\n  background-color: #f7f7f7;\n  border-radius: 35rpx;\n  padding: 0 30rpx;\n  font-size: 30rpx;\n  margin-right: 20rpx;\n}\n\n.search-btn {\n  height: 70rpx;\n  line-height: 70rpx;\n  font-size: 30rpx;\n  color: #fff;\n  padding: 0 30rpx;\n  border-radius: 35rpx;\n  white-space: nowrap;\n}\n\n/* --- 搜索结果区 --- */\n.result-list {\n  flex: 1;\n  padding: 20rpx 30rpx;\n}\n\n.status-msg {\n  text-align: center;\n  padding: 50rpx;\n  color: #999;\n}\n\n.user-item {\n  display: flex;\n  align-items: center;\n  padding: 20rpx 0;\n  border-bottom: 1rpx solid #f0f0f0;\n}\n\n.avatar {\n  width: 100rpx;\n  height: 100rpx;\n  border-radius: 50%;\n  margin-right: 20rpx;\n}\n\n.user-info {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n}\n\n.user-nickname {\n  font-size: 34rpx;\n  font-weight: bold;\n  color: #333;\n}\n\n.user-username {\n  font-size: 26rpx;\n  color: #999;\n  margin-top: 5rpx;\n}\n\n.add-btn {\n  height: 70rpx;\n  line-height: 70rpx;\n  font-size: 30rpx;\n  color: #fff;\n  padding: 0 20rpx;\n  border-radius: 35rpx;\n}\n\n.add-btn[disabled] {\n  background-color: #ccc !important;\n}\n</style>","import MiniProgramPage from 'C:/Users/HP/Desktop/软件工程/demo1/DemonTest/pages/message/friends/addFriend.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":";;AA8CA,MAAK,YAAU;AAAA,EACb,OAAO;AACL,WAAO;AAAA,MACL,cAAc;AAAA,MACd,eAAe;AAAA,MACf,cAAc;AAAA;AAAA,MACd,cAAc;AAAA;AAAA;EAEjB;AAAA,EACD,SAAS;AAAA,IACP,SAAS;AACPA,oBAAG,MAAC,aAAY;AAAA,IACjB;AAAA,IAED,cAAc,MAAM;AAClB,UAAI,KAAK;AAAU,eAAO;AAC1B,UAAI,KAAK;AAAgB,eAAO;AAChC,aAAO;AAAA,IACR;AAAA;AAAA,IAGD,aAAa;AACX,YAAM,UAAU,KAAK,cAAc,KAAI;AACvC,UAAI,CAAC,SAAS;AACZA,sBAAG,MAAC,UAAU,EAAE,OAAO,YAAY,MAAM,OAAK,CAAG;AACjD;AAAA,MACF;AAEA,WAAK,eAAe;AACpB,WAAK,eAAe;AAqBpB,iBAAW,MAAM;AACf,YAAI,YAAY,QAAQ;AACtB,eAAK,eAAe;AAAA,YAClB,IAAI;AAAA,YACJ,UAAU;AAAA,YACV,UAAU;AAAA,YACV,QAAQ;AAAA,YACR,UAAU;AAAA,YACV,gBAAgB;AAAA;AAElB,eAAK,eAAe;AAAA,eACf;AACL,eAAK,eAAe;AACpB,eAAK,eAAe;AAAA,QACtB;AAAA,MACD,GAAE,GAAG;AAAA,IACP;AAAA;AAAA,IAGD,YAAY,MAAM;AAChBA,oBAAAA,MAAI,UAAU;AAAA,QACZ,OAAO;AAAA,QACP,SAAS,QAAQ,KAAK,QAAQ;AAAA,QAC9B,aAAa;AAAA,QACb,SAAS,CAAC,QAAQ;AAChB,cAAI,IAAI,SAAS;AAoBfA,0BAAG,MAAC,UAAU,EAAE,OAAO,SAAS,MAAM,UAAQ,CAAG;AACjD,iBAAK,iBAAiB;AAAA,UACxB;AAAA,QACF;AAAA,MACF,CAAC;AAAA,IACH;AAAA,EACF;AACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnJA,GAAG,WAAW,eAAe;"}